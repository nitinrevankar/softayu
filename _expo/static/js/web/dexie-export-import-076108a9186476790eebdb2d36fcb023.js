__d(function(e,t,n,r,i,o,a){"use strict";Object.defineProperty(o,'__esModule',{value:!0}),Object.defineProperty(o,"default",{enumerable:!0,get:function(){return $}}),Object.defineProperty(o,"exportDB",{enumerable:!0,get:function(){return C}}),Object.defineProperty(o,"importDB",{enumerable:!0,get:function(){return V}}),Object.defineProperty(o,"importInto",{enumerable:!0,get:function(){return M}}),Object.defineProperty(o,"peakImportFile",{enumerable:!0,get:function(){return K}});var u,c=t(a[0]),s=(u=c)&&u.__esModule?u:{default:u},f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)};function l(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function u(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})}function p(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function y(e){return[e.schema.primKey].concat(e.schema.indexes).map(function(e){return e.src}).join(',')}function h(e){for(var t={},n=0,r=e.tables;n<r.length;n++){var i=r[n];t[i.name]=i.schema}return t}function d(e,t){return new Promise(function(n,r){var i=new FileReader;i.onabort=function(e){return r(new Error("file read aborted"))},i.onerror=function(e){return r(e.target.error)},i.onload=function(e){return n(e.target.result)},'binary'===t?i.readAsArrayBuffer(e):i.readAsText(e)})}function v(e,t){if('undefined'==typeof FileReaderSync)throw new Error('FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.');var n=new FileReaderSync;return'binary'===t?n.readAsArrayBuffer(e):n.readAsText(e)}var b='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:void 0!==e?e:'undefined'!=typeof self?self:{};function m(e,t){return e(t={exports:{}},t.exports),t.exports}for(var g=m(function(e,t){e.exports=(function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,n,r,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,i)}function n(e){return function(){var n=this,r=arguments;return new Promise(function(i,o){var a=e.apply(n,r);function u(e){t(a,i,o,u,c,"next",e)}function c(e){t(a,i,o,u,c,"throw",e)}u(void 0)})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t){return p(e)||h(e,t)||v()}function f(e){return l(e)||y(e)||d()}function l(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function p(e){if(Array.isArray(e))return e}function y(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function h(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function v(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var b=function e(t){r(this,e),this.p=new Promise(t)};b.__typeson__type__='TypesonPromise','undefined'!=typeof Symbol&&(b.prototype[Symbol.toStringTag]='TypesonPromise'),b.prototype.then=function(e,t){var n=this;return new b(function(r,i){n.p.then(function(t){r(e?e(t):t)}).catch(function(e){return t?t(e):Promise.reject(e)}).then(r,i)})},b.prototype.catch=function(e){return this.then(null,e)},b.resolve=function(e){return new b(function(t){t(e)})},b.reject=function(e){return new b(function(t,n){n(e)})},['all','race'].forEach(function(e){b[e]=function(t){return new b(function(n,r){Promise[e](t.map(function(e){return e&&e.constructor&&'TypesonPromise'===e.constructor.__typeson__type__?e.p:e})).then(n,r)})}});var m={}.toString,g={}.hasOwnProperty,w=Object.getPrototypeOf,O=g.toString;function S(e,t){return _(e)&&'function'==typeof e.then&&(!t||'function'==typeof e.catch)}function E(e){return m.call(e).slice(8,-1)}function A(t,n){if(!t||'object'!==e(t))return!1;var r=w(t);if(!r)return null===n;var i=g.call(r,'constructor')&&r.constructor;return'function'!=typeof i?null===n:n===i||null!==n&&O.call(i)===O.call(n)||'function'==typeof n&&'string'==typeof i.__typeson__type__&&i.__typeson__type__===n.__typeson__type__}function T(e){return!(!e||'Object'!==E(e))&&(!w(e)||A(e,Object))}function N(e){if(!e||'Object'!==E(e))return!1;var t=w(e);return!t||A(e,Object)||N(t)}function _(t){return t&&'object'===e(t)}function j(e){return e.replace(/~/g,'~0').replace(/\./g,'~1')}function P(e){return e.replace(/~1/g,'.').replace(/~0/g,'~')}function I(e,t){if(''===t)return e;var n=t.indexOf('.');if(n>-1){var r=e[P(t.slice(0,n))];return void 0===r?void 0:I(r,t.slice(n+1))}return e[P(t)]}function k(e,t,n){if(''===t)return n;var r=t.indexOf('.');return r>-1?k(e[P(t.slice(0,r))],t.slice(r+1),n):(e[P(t)]=n,e)}function B(t){return null===t?'null':Array.isArray(t)?'array':e(t)}var x=Object.keys,C=Array.isArray,L={}.hasOwnProperty,U=['type','replaced','iterateIn','iterateUnsetNumeric'];function R(e,t){if(''===e.keypath)return-1;var n=e.keypath.match(/\./g)||0,r=t.keypath.match(/\./g)||0;return n&&(n=n.length),r&&(r=r.length),n>r?-1:n<r?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var F=(function(){function t(e){r(this,t),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return o(t,[{key:"stringify",value:function(e,t,n,r){r=c({},this.options,{},r,{stringification:!0});var i=this.encapsulate(e,null,r);return C(i)?JSON.stringify(i[0],t,n):i.then(function(e){return JSON.stringify(e,t,n)})}},{key:"stringifySync",value:function(e,t,n,r){return this.stringify(e,t,n,c({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"stringifyAsync",value:function(e,t,n,r){return this.stringify(e,t,n,c({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"parse",value:function(e,t,n){return n=c({},this.options,{},n,{parse:!0}),this.revive(JSON.parse(e,t),n)}},{key:"parseSync",value:function(e,t,n){return this.parse(e,t,c({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"parseAsync",value:function(e,t,n){return this.parse(e,t,c({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"specialTypeNames",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)}},{key:"rootTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)}},{key:"encapsulate",value:function(r,i,o){var a=(o=c({sync:!0},this.options,{},o)).sync,u=this,l={},p=[],y=[],h=[],d=!('cyclic'in o)||o.cyclic,v=o.encapsulateObserver,m=E('',r,d,i||{},h);function g(e){var n=Object.values(l);if(o.iterateNone)return n.length?n[0]:t.getJSONType(e);if(n.length){if(o.returnTypeNames)return f(new Set(n));e&&T(e)&&!L.call(e,'$types')?e.$types=l:e={$:e,$types:{$:l}}}else _(e)&&L.call(e,'$types')&&(e={$:e,$types:!0});return!o.returnTypeNames&&e}function w(e,t){return O.apply(this,arguments)}function O(){return O=n(regeneratorRuntime.mark(function e(t,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.map(function(e){return e[1].p}));case 2:return i=e.sent,e.next=5,Promise.all(i.map((function(){var e=n(regeneratorRuntime.mark(function e(n){var i,o,a,u,c,f,l,p,y,h,d,v,m,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],o=r.splice(0,1),a=s(o,1),u=a[0],c=s(u,7),f=c[0],l=c[2],p=c[3],y=c[4],h=c[5],d=c[6],v=E(f,n,l,p,i,!0,d),m=A(v,b),!f||!m){e.next=11;break}return e.next=8,v.p;case 8:return g=e.sent,y[h]=g,e.abrupt("return",w(t,i));case 11:return f?y[h]=v:t=m?v.p:v,e.abrupt("return",w(t,i));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}})()));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}},e)})),O.apply(this,arguments)}function S(e,t,n){Object.assign(e,t);var r=U.map(function(t){var n=e[t];return delete e[t],n});n(),U.forEach(function(t,n){e[t]=r[n]})}function E(n,r,i,a,c,s,f){var h,d={},m=e(r),g=v?function(e){var o=f||a.type||t.getJSONType(r);v(Object.assign(e||d,{keypath:n,value:r,cyclic:i,stateObj:a,promisesData:c,resolvingTypesonPromise:s,awaitingTypesonPromise:A(r,b)},{type:o}))}:null;if(['string','boolean','number','undefined'].includes(m))return void 0===r||'number'===m&&(isNaN(r)||r===-1/0||r===1/0)?(h=a.replaced?r:N(n,r,a,c,!1,s,g))!==r&&(d={replaced:h}):h=r,g&&g(),h;if(null===r)return g&&g(),r;if(i&&!a.iterateIn&&!a.iterateUnsetNumeric&&r&&'object'===e(r)){var w=p.indexOf(r);if(!(w<0))return l[n]='#',g&&g({cyclicKeypath:y[w]}),'#'+y[w];!0===i&&(p.push(r),y.push(n))}var O,_=T(r),P=C(r),I=(_||P)&&(!u.plainObjectReplacers.length||a.replaced)||a.iterateIn?r:N(n,r,a,c,_||P,null,g);if(I!==r?(h=I,d={replaced:I}):''===n&&A(r,b)?(c.push([n,r,i,a,void 0,void 0,a.type]),h=r):P&&'object'!==a.iterateIn||'array'===a.iterateIn?(O=new Array(r.length),d={clone:O}):(['function','symbol'].includes(e(r))||'toJSON'in r||A(r,b)||A(r,Promise)||A(r,ArrayBuffer))&&!_&&'object'!==a.iterateIn?h=r:(O={},a.addLength&&(O.length=r.length),d={clone:O}),g&&g(),o.iterateNone)return O||h;if(!O)return h;if(a.iterateIn){var k=function(e){var t={ownKeys:L.call(r,e)};S(a,t,function(){var t=n+(n?'.':'')+j(e),o=E(t,r[e],Boolean(i),a,c,s);A(o,b)?c.push([t,o,Boolean(i),a,O,e,a.type]):void 0!==o&&(O[e]=o)})};for(var B in r)k(B);g&&g({endIterateIn:!0,end:!0})}else x(r).forEach(function(e){var t=n+(n?'.':'')+j(e);S(a,{ownKeys:!0},function(){var n=E(t,r[e],Boolean(i),a,c,s);A(n,b)?c.push([t,n,Boolean(i),a,O,e,a.type]):void 0!==n&&(O[e]=n)})}),g&&g({endIterateOwn:!0,end:!0});if(a.iterateUnsetNumeric){for(var U=r.length,R=function(e){if(!(e in r)){var t=n+(n?'.':'')+e;S(a,{ownKeys:!1},function(){var n=E(t,void 0,Boolean(i),a,c,s);A(n,b)?c.push([t,n,Boolean(i),a,O,e,a.type]):void 0!==n&&(O[e]=n)})}},F=0;F<U;F++)R(F);g&&g({endIterateUnsetNumeric:!0,end:!0})}return O}function N(e,t,n,r,i,o,c){for(var s=i?u.plainObjectReplacers:u.nonplainObjectReplacers,f=s.length;f--;){var p=s[f];if(p.test(t,n)){var y=p.type;if(u.revivers[y]){var h=l[e];l[e]=h?[y].concat(h):y}return Object.assign(n,{type:y,replaced:!0}),!a&&p.replaceAsync||p.replace?(c&&c({replacing:!0}),E(e,p[a||!p.replaceAsync?'replace':'replaceAsync'](t,n),d&&'readonly',n,r,o,y)):(c&&c({typeDetected:!0}),E(e,t,d&&'readonly',n,r,o,y))}}return t}return h.length?a&&o.throwOnBadSyncType?(function(){throw new TypeError('Sync method requested but async result obtained')})():Promise.resolve(w(m,h)).then(g):!a&&o.throwOnBadSyncType?(function(){throw new TypeError('Async method requested but sync result obtained')})():o.stringification&&a?[g(m)]:a?g(m):Promise.resolve(g(m))}},{key:"encapsulateSync",value:function(e,t,n){return this.encapsulate(e,t,c({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"encapsulateAsync",value:function(e,t,n){return this.encapsulate(e,t,c({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"revive",value:function(e,t){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var r=(t=c({sync:!0},this.options,{},t)).sync,i=[],o={},a=!0;n.$&&T(n.$)&&(e=e.$,n=n.$,a=!1);var u=this;function f(e,t){var n=s(u.revivers[e]||[],1)[0];if(!n)throw new Error('Unregistered type: '+e);return r&&!('revive'in n)?t:n[r&&n.revive?'revive':!r&&n.reviveAsync?'reviveAsync':'revive'](t,o)}function l(){var t=[];if(Object.entries(n).forEach(function(e){var r=s(e,2),i=r[0],o=r[1];'#'!==o&&[].concat(o).forEach(function(e){s(u.revivers[e]||[null,{}],2)[1].plain&&(t.push({keypath:i,type:e}),delete n[i])})}),t.length)return t.sort(R).reduce(function t(n,r){var i=r.keypath,o=r.type;if(S(n))return n.then(function(e){return t(e,{keypath:i,type:o})});var a=I(e,i);if(A(a=f(o,a),b))return a.then(function(t){var n=k(e,i,t);n===t&&(e=n)});var u=k(e,i,a);u===a&&(e=u)},void 0)}var p=[];function y(e,t,r,o,u){if(!a||'$types'!==e){var c=n[e],l=C(t);if(l||T(t)){var h=l?new Array(t.length):{};for(x(t).forEach(function(n){var i=y(e+(e?'.':'')+j(n),t[n],r||h,h,n),o=function(e){return A(e,D)?h[n]=void 0:void 0!==e&&(h[n]=e),e};A(i,b)?p.push(i.then(function(e){return o(e)})):o(i)}),t=h;i.length;){var d=s(i[0],4),v=d[0],m=d[1],g=d[2],w=d[3],O=I(v,m);if(void 0===O)break;g[w]=O,i.splice(0,1)}}if(!c)return t;if('#'===c){var S=I(r,t.slice(1));return void 0===S&&i.push([r,t.slice(1),o,u]),S}return[].concat(c).reduce(function e(t,n){return A(t,b)?t.then(function(t){return e(t,n)}):f(n,t)},t)}}function h(e){return A(e,D)?void 0:e}var d,v=l();return A(v,b)?d=v.then(function(){return e}):(d=y('',e,null),p.length&&(d=b.resolve(d).then(function(e){return b.all([e].concat(p))}).then(function(e){return s(e,1)[0]}))),S(d)?r&&t.throwOnBadSyncType?(function(){throw new TypeError('Sync method requested but async result obtained')})():A(d,b)?d.p.then(h):d:!r&&t.throwOnBadSyncType?(function(){throw new TypeError('Async method requested but sync result obtained')})():r?h(d):Promise.resolve(h(d))}},{key:"reviveSync",value:function(e,t){return this.revive(e,c({throwOnBadSyncType:!0},t,{sync:!0}))}},{key:"reviveAsync",value:function(e,t){return this.revive(e,c({throwOnBadSyncType:!0},t,{sync:!1}))}},{key:"register",value:function(e,n){return n=n||{},[].concat(e).forEach(function e(r){var i=this;if(C(r))return r.map(function(t){return e.call(i,t)});r&&x(r).forEach(function(e){if('#'===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(t.JSON_TYPES.includes(e))throw new TypeError('Plain JSON object types are reserved as type names');var i=r[e],o=i&&i.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,a=o.filter(function(t){return t.type===e});if(a.length&&(o.splice(o.indexOf(a[0]),1),delete this.revivers[e],delete this.types[e]),'function'==typeof i){var u=i;i={test:function(e){return e&&e.constructor===u},replace:function(e){return c({},e)},revive:function(e){return Object.assign(Object.create(u.prototype),e)}}}else if(C(i)){var f=s(i,3);i={test:f[0],replace:f[1],revive:f[2]}}if(i&&i.test){var l={type:e,test:i.test.bind(i)};i.replace&&(l.replace=i.replace.bind(i)),i.replaceAsync&&(l.replaceAsync=i.replaceAsync.bind(i));var p='number'==typeof n.fallback?n.fallback:n.fallback?0:1/0;if(i.testPlainObjects?this.plainObjectReplacers.splice(p,0,l):this.nonplainObjectReplacers.splice(p,0,l),i.revive||i.reviveAsync){var y={};i.revive&&(y.revive=i.revive.bind(i)),i.reviveAsync&&(y.reviveAsync=i.reviveAsync.bind(i)),this.revivers[e]=[y,{plain:i.testPlainObjects}]}this.types[e]=i}},this)},this),this}}]),t})(),D=function e(){r(this,e)};return D.__typeson__type__='TypesonUndefined',F.Undefined=D,F.Promise=b,F.isThenable=S,F.toStringTag=E,F.hasConstructorOf=A,F.isObject=_,F.isPlainObject=T,F.isUserObject=N,F.escapeKeyPathComponent=j,F.unescapeKeyPathComponent=P,F.getByKeyPath=I,F.getJSONType=B,F.JSON_TYPES=['null','boolean','number','string','array','object'],F})()}),w=m(function(e,t){e.exports=(function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){return(function(e){if(Array.isArray(e))return a(e)})(e)||(function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)})(e)||(function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}})(e)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y(e,t){return(function(e){if(Array.isArray(e))return e})(e)||(function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}})(e,t)||d(e,t)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function h(e){return(function(e){if(Array.isArray(e))return v(e)})(e)||(function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)})(e)||d(e)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function d(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function e(t){c(this,e),this.p=new Promise(t)};m.__typeson__type__="TypesonPromise","undefined"!=typeof Symbol&&(m.prototype[Symbol.toStringTag]="TypesonPromise"),m.prototype.then=function(e,t){var n=this;return new m(function(r,i){n.p.then(function(t){r(e?e(t):t)}).catch(function(e){return t?t(e):Promise.reject(e)}).then(r,i)})},m.prototype.catch=function(e){return this.then(null,e)},m.resolve=function(e){return new m(function(t){t(e)})},m.reject=function(e){return new m(function(t,n){n(e)})},["all","race"].forEach(function(e){m[e]=function(t){return new m(function(n,r){Promise[e](t.map(function(e){return e&&e.constructor&&"TypesonPromise"===e.constructor.__typeson__type__?e.p:e})).then(n,r)})}});var g={}.toString,w={}.hasOwnProperty,O=Object.getPrototypeOf,S=w.toString;function E(e,t){return _(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function A(e){return g.call(e).slice(8,-1)}function T(e,t){if(!e||"object"!==u(e))return!1;var n=O(e);if(!n)return null===t;var r=w.call(n,"constructor")&&n.constructor;return"function"!=typeof r?null===t:t===r||null!==t&&S.call(r)===S.call(t)||"function"==typeof t&&"string"==typeof r.__typeson__type__&&r.__typeson__type__===t.__typeson__type__}function N(e){return!(!e||"Object"!==A(e))&&(!O(e)||T(e,Object))}function _(e){return e&&"object"===u(e)}function j(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function P(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function I(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[P(t.slice(0,n))];return void 0===r?void 0:I(r,t.slice(n+1))}return e[P(t)]}function k(e,t,n){if(""===t)return n;var r=t.indexOf(".");return r>-1?k(e[P(t.slice(0,r))],t.slice(r+1),n):(e[P(t)]=n,e)}function B(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var x=Object.keys,C=Array.isArray,L={}.hasOwnProperty,U=["type","replaced","iterateIn","iterateUnsetNumeric"];function R(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function F(e,t){if(""===e.keypath)return-1;var n=e.keypath.match(/\./g)||0,r=t.keypath.match(/\./g)||0;return n&&(n=n.length),r&&(r=r.length),n>r?-1:n<r?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var D=(function(){function e(t){c(this,e),this.options=t,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return(function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)})(e,[{key:"stringify",value:function(e,t,n,r){r=p(p(p({},this.options),r),{},{stringification:!0});var i=this.encapsulate(e,null,r);return C(i)?JSON.stringify(i[0],t,n):i.then(function(e){return JSON.stringify(e,t,n)})}},{key:"stringifySync",value:function(e,t,n,r){return this.stringify(e,t,n,p(p({throwOnBadSyncType:!0},r),{},{sync:!0}))}},{key:"stringifyAsync",value:function(e,t,n,r){return this.stringify(e,t,n,p(p({throwOnBadSyncType:!0},r),{},{sync:!1}))}},{key:"parse",value:function(e,t,n){return n=p(p(p({},this.options),n),{},{parse:!0}),this.revive(JSON.parse(e,t),n)}},{key:"parseSync",value:function(e,t,n){return this.parse(e,t,p(p({throwOnBadSyncType:!0},n),{},{sync:!0}))}},{key:"parseAsync",value:function(e,t,n){return this.parse(e,t,p(p({throwOnBadSyncType:!0},n),{},{sync:!1}))}},{key:"specialTypeNames",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)}},{key:"rootTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)}},{key:"encapsulate",value:function(t,n,r){var i=R(function(e,t){return B(Promise.all(t.map(function(e){return e[1].p})),function(n){return B(Promise.all(n.map(R(function(n){var r=!1,o=[],a=y(t.splice(0,1),1),u=y(a[0],7),c=u[0],s=u[2],f=u[3],l=u[4],p=u[5],h=u[6],d=O(c,n,s,f,o,!0,h),v=T(d,m);return(function(e,t){var n=e();return n&&n.then?n.then(t):t(n)})(function(){if(c&&v)return B(d.p,function(t){return l[p]=t,r=!0,i(e,o)})},function(t){return r?t:(c?l[p]=d:e=v?d.p:d,i(e,o))})}))),function(){return e})})}),o=(r=p(p({sync:!0},this.options),r)).sync,a=this,c={},s=[],f=[],l=[],d=!("cyclic"in r)||r.cyclic,v=r.encapsulateObserver,b=O("",t,d,n||{},l);function g(t){var n=Object.values(c);if(r.iterateNone)return n.length?n[0]:e.getJSONType(t);if(n.length){if(r.returnTypeNames)return h(new Set(n));t&&N(t)&&!L.call(t,"$types")?t.$types=c:t={$:t,$types:{$:c}}}else _(t)&&L.call(t,"$types")&&(t={$:t,$types:!0});return!r.returnTypeNames&&t}function w(e,t,n){Object.assign(e,t);var r=U.map(function(t){var n=e[t];return delete e[t],n});n(),U.forEach(function(t,n){e[t]=r[n]})}function O(t,n,i,o,l,p,y){var h,d={},b=u(n),g=v?function(r){var a=y||o.type||e.getJSONType(n);v(Object.assign(r||d,{keypath:t,value:n,cyclic:i,stateObj:o,promisesData:l,resolvingTypesonPromise:p,awaitingTypesonPromise:T(n,m)},{type:a}))}:null;if(["string","boolean","number","undefined"].includes(b))return void 0===n||Number.isNaN(n)||n===Number.NEGATIVE_INFINITY||n===Number.POSITIVE_INFINITY?(h=o.replaced?n:S(t,n,o,l,!1,p,g))!==n&&(d={replaced:h}):h=n,g&&g(),h;if(null===n)return g&&g(),n;if(i&&!o.iterateIn&&!o.iterateUnsetNumeric&&n&&"object"===u(n)){var E=s.indexOf(n);if(!(E<0))return c[t]="#",g&&g({cyclicKeypath:f[E]}),"#"+f[E];!0===i&&(s.push(n),f.push(t))}var A,_=N(n),P=C(n),I=(_||P)&&(!a.plainObjectReplacers.length||o.replaced)||o.iterateIn?n:S(t,n,o,l,_||P,null,g);if(I!==n?(h=I,d={replaced:I}):""===t&&T(n,m)?(l.push([t,n,i,o,void 0,void 0,o.type]),h=n):P&&"object"!==o.iterateIn||"array"===o.iterateIn?(A=new Array(n.length),d={clone:A}):(["function","symbol"].includes(u(n))||"toJSON"in n||T(n,m)||T(n,Promise)||T(n,ArrayBuffer))&&!_&&"object"!==o.iterateIn?h=n:(A={},o.addLength&&(A.length=n.length),d={clone:A}),g&&g(),r.iterateNone)return A||h;if(!A)return h;if(o.iterateIn){var k=function(e){var r={ownKeys:L.call(n,e)};w(o,r,function(){var r=t+(t?".":"")+j(e),a=O(r,n[e],Boolean(i),o,l,p);T(a,m)?l.push([r,a,Boolean(i),o,A,e,o.type]):void 0!==a&&(A[e]=a)})};for(var B in n)k(B);g&&g({endIterateIn:!0,end:!0})}else x(n).forEach(function(e){var r=t+(t?".":"")+j(e);w(o,{ownKeys:!0},function(){var t=O(r,n[e],Boolean(i),o,l,p);T(t,m)?l.push([r,t,Boolean(i),o,A,e,o.type]):void 0!==t&&(A[e]=t)})}),g&&g({endIterateOwn:!0,end:!0});if(o.iterateUnsetNumeric){for(var U=n.length,R=function(e){if(!(e in n)){var r=t+(t?".":"")+e;w(o,{ownKeys:!1},function(){var t=O(r,void 0,Boolean(i),o,l,p);T(t,m)?l.push([r,t,Boolean(i),o,A,e,o.type]):void 0!==t&&(A[e]=t)})}},F=0;F<U;F++)R(F);g&&g({endIterateUnsetNumeric:!0,end:!0})}return A}function S(e,t,n,r,i,u,s){for(var f=i?a.plainObjectReplacers:a.nonplainObjectReplacers,l=f.length;l--;){var p=f[l];if(p.test(t,n)){var y=p.type;if(a.revivers[y]){var h=c[e];c[e]=h?[y].concat(h):y}return Object.assign(n,{type:y,replaced:!0}),!o&&p.replaceAsync||p.replace?(s&&s({replacing:!0}),O(e,p[o||!p.replaceAsync?"replace":"replaceAsync"](t,n),d&&"readonly",n,r,u,y)):(s&&s({typeDetected:!0}),O(e,t,d&&"readonly",n,r,u,y))}}return t}return l.length?o&&r.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():Promise.resolve(i(b,l)).then(g):!o&&r.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():r.stringification&&o?[g(b)]:o?g(b):Promise.resolve(g(b))}},{key:"encapsulateSync",value:function(e,t,n){return this.encapsulate(e,t,p(p({throwOnBadSyncType:!0},n),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(e,t,n){return this.encapsulate(e,t,p(p({throwOnBadSyncType:!0},n),{},{sync:!1}))}},{key:"revive",value:function(e,t){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var r=(t=p(p({sync:!0},this.options),t)).sync,i=[],o={},a=!0;n.$&&N(n.$)&&(e=e.$,n=n.$,a=!1);var u=this;function c(e,t){var n=y(u.revivers[e]||[],1)[0];if(!n)throw new Error("Unregistered type: "+e);return r&&!("revive"in n)?t:n[r&&n.revive?"revive":!r&&n.reviveAsync?"reviveAsync":"revive"](t,o)}var s=[];function f(e){return T(e,V)?void 0:e}var l,h=(function(){var t=[];if(Object.entries(n).forEach(function(e){var r=y(e,2),i=r[0],o=r[1];"#"!==o&&[].concat(o).forEach(function(e){y(u.revivers[e]||[null,{}],2)[1].plain&&(t.push({keypath:i,type:e}),delete n[i])})}),t.length)return t.sort(F).reduce(function t(n,r){var i=r.keypath,o=r.type;if(E(n))return n.then(function(e){return t(e,{keypath:i,type:o})});var a=I(e,i);if(T(a=c(o,a),m))return a.then(function(t){var n=k(e,i,t);n===t&&(e=n)});var u=k(e,i,a);u===a&&(e=u)},void 0)})();return T(h,m)?l=h.then(function(){return e}):(l=(function e(t,r,o,u,f){if(!a||"$types"!==t){var l=n[t],p=C(r);if(p||N(r)){var h=p?new Array(r.length):{};for(x(r).forEach(function(n){var i=e(t+(t?".":"")+j(n),r[n],o||h,h,n),a=function(e){return T(e,V)?h[n]=void 0:void 0!==e&&(h[n]=e),e};T(i,m)?s.push(i.then(function(e){return a(e)})):a(i)}),r=h;i.length;){var d=y(i[0],4),v=d[0],b=d[1],g=d[2],w=d[3],O=I(v,b);if(void 0===O)break;g[w]=O,i.splice(0,1)}}if(!l)return r;if("#"===l){var S=I(o,r.slice(1));return void 0===S&&i.push([o,r.slice(1),u,f]),S}return[].concat(l).reduce(function e(t,n){return T(t,m)?t.then(function(t){return e(t,n)}):c(n,t)},r)}})("",e,null),s.length&&(l=m.resolve(l).then(function(e){return m.all([e].concat(s))}).then(function(e){return y(e,1)[0]}))),E(l)?r&&t.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():T(l,m)?l.p.then(f):l:!r&&t.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():r?f(l):Promise.resolve(f(l))}},{key:"reviveSync",value:function(e,t){return this.revive(e,p(p({throwOnBadSyncType:!0},t),{},{sync:!0}))}},{key:"reviveAsync",value:function(e,t){return this.revive(e,p(p({throwOnBadSyncType:!0},t),{},{sync:!1}))}},{key:"register",value:function(t,n){return n=n||{},[].concat(t).forEach(function t(r){var i=this;if(C(r))return r.map(function(e){return t.call(i,e)});r&&x(r).forEach(function(t){if("#"===t)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(e.JSON_TYPES.includes(t))throw new TypeError("Plain JSON object types are reserved as type names");var i=r[t],o=i&&i.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,a=o.filter(function(e){return e.type===t});if(a.length&&(o.splice(o.indexOf(a[0]),1),delete this.revivers[t],delete this.types[t]),"function"==typeof i){var u=i;i={test:function(e){return e&&e.constructor===u},replace:function(e){return p({},e)},revive:function(e){return Object.assign(Object.create(u.prototype),e)}}}else if(C(i)){var c=y(i,3);i={test:c[0],replace:c[1],revive:c[2]}}if(i&&i.test){var s={type:t,test:i.test.bind(i)};i.replace&&(s.replace=i.replace.bind(i)),i.replaceAsync&&(s.replaceAsync=i.replaceAsync.bind(i));var f="number"==typeof n.fallback?n.fallback:n.fallback?0:Number.POSITIVE_INFINITY;if(i.testPlainObjects?this.plainObjectReplacers.splice(f,0,s):this.nonplainObjectReplacers.splice(f,0,s),i.revive||i.reviveAsync){var l={};i.revive&&(l.revive=i.revive.bind(i)),i.reviveAsync&&(l.reviveAsync=i.reviveAsync.bind(i)),this.revivers[t]=[l,{plain:i.testPlainObjects}]}this.types[t]=i}},this)},this),this}}]),e})(),V=function e(){c(this,e)};V.__typeson__type__="TypesonUndefined",D.Undefined=V,D.Promise=m,D.isThenable=E,D.toStringTag=A,D.hasConstructorOf=T,D.isObject=_,D.isPlainObject=N,D.isUserObject=function e(t){if(!t||"Object"!==A(t))return!1;var n=O(t);return!n||T(t,Object)||e(n)},D.escapeKeyPathComponent=j,D.unescapeKeyPathComponent=P,D.getByKeyPath=I,D.getJSONType=function(e){return null===e?"null":Array.isArray(e)?"array":u(e)},D.JSON_TYPES=["null","boolean","number","string","array","object"];for(var K={userObject:{test:function(e,t){return D.isUserObject(e)},replace:function(e){return(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e})({},e)},revive:function(e){return e}}},M=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(e){return String(Number.parseInt(e))!==e})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(n){var r=e[n];t[n]=r}),t}}},{sparseUndefined:{test:function(e,t){return void 0===e&&!1===t.ownKeys},replace:function(e){return 0},revive:function(e){}}}],J={undef:{test:function(e,t){return void 0===e&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new D.Undefined}}},$={StringObject:{test:function(t){return"String"===D.toStringTag(t)&&"object"===e(t)},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(t){return"Boolean"===D.toStringTag(t)&&"object"===e(t)},replace:function(e){return Boolean(e)},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(t){return"Number"===D.toStringTag(t)&&"object"===e(t)},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},G=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],Y={date:{test:function(e){return"Date"===D.toStringTag(e)},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return"NaN"===e?new Date(Number.NaN):new Date(e)}}},q={regexp:{test:function(e){return"RegExp"===D.toStringTag(e)},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,n=e.flags;return new RegExp(t,n)}}},z={map:{test:function(e){return"Map"===D.toStringTag(e)},replace:function(e){return o(e.entries())},revive:function(e){return new Map(e)}}},H={set:{test:function(e){return"Set"===D.toStringTag(e)},replace:function(e){return o(e.values())},revive:function(e){return new Set(e)}}},X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q=new Uint8Array(256),W=0;W<X.length;W++)Q[X.charCodeAt(W)]=W;var Z=function(e,t,n){null==n&&(n=e.byteLength);for(var r=new Uint8Array(e,t||0,n),i=r.length,o="",a=0;a<i;a+=3)o+=X[r[a]>>2],o+=X[(3&r[a])<<4|r[a+1]>>4],o+=X[(15&r[a+1])<<2|r[a+2]>>6],o+=X[63&r[a+2]];return i%3==2?o=o.slice(0,-1)+"=":i%3==1&&(o=o.slice(0,-2)+"=="),o},ee=function(e){var t,n,r,i,o=e.length,a=.75*e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);for(var c=new ArrayBuffer(a),s=new Uint8Array(c),f=0;f<o;f+=4)t=Q[e.charCodeAt(f)],n=Q[e.charCodeAt(f+1)],r=Q[e.charCodeAt(f+2)],i=Q[e.charCodeAt(f+3)],s[u++]=t<<2|n>>4,s[u++]=(15&n)<<4|r>>2,s[u++]=(3&r)<<6|63&i;return c},te={arraybuffer:{test:function(e){return"ArrayBuffer"===D.toStringTag(e)},replace:function(e,t){t.buffers||(t.buffers=[]);var n=t.buffers.indexOf(e);return n>-1?{index:n}:(t.buffers.push(e),Z(e))},revive:function(t,n){if(n.buffers||(n.buffers=[]),"object"===e(t))return n.buffers[t.index];var r=ee(t);return n.buffers.push(r),r}}},ne="undefined"==typeof self?b:self,re={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){var t=e,n=ne[t];n&&(re[e.toLowerCase()]={test:function(e){return D.toStringTag(e)===t},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.length;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,length:i}:(t.buffers.push(n),{encoded:Z(n),byteOffset:r,length:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var r,i=e.byteOffset,o=e.length,a=e.encoded,u=e.index;return"index"in e?r=t.buffers[u]:(r=ee(a),t.buffers.push(r)),new n(r,i,o)}})});var ie={dataview:{test:function(e){return"DataView"===D.toStringTag(e)},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.byteLength;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,byteLength:i}:(t.buffers.push(n),{encoded:Z(n),byteOffset:r,byteLength:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var n,r=e.byteOffset,i=e.byteLength,o=e.encoded,a=e.index;return"index"in e?n=t.buffers[a]:(n=ee(o),t.buffers.push(n)),new DataView(n,r,i)}}},oe={IntlCollator:{test:function(e){return D.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return D.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return D.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function ae(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}var ue={file:{test:function(e){return"File"===D.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),200!==t.status&&0!==t.status)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,n=e.type,r=e.stringContents,i=e.lastModified;return new File([ae(r)],t,{type:n,lastModified:i})},replaceAsync:function(e){return new D.Promise(function(t,n){var r=new FileReader;r.addEventListener("load",function(){t({type:e.type,stringContents:r.result,name:e.name,lastModified:e.lastModified})}),r.addEventListener("error",function(){n(r.error)}),r.readAsBinaryString(e)})}}},ce={bigint:{test:function(e){return"bigint"==typeof e},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},se={bigintObject:{test:function(t){return"object"===e(t)&&D.hasConstructorOf(t,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},fe={cryptokey:{test:function(e){return"CryptoKey"===D.toStringTag(e)&&e.extractable},replaceAsync:function(e){return new D.Promise(function(t,n){crypto.subtle.exportKey("jwk",e).catch(function(e){n(e)}).then(function(n){t({jwk:n,algorithm:e.algorithm,usages:e.usages})})})},revive:function(e){var t=e.jwk,n=e.algorithm,r=e.usages;return crypto.subtle.importKey("jwk",t,n,!0,r)}}};return[K,J,M,$,G,Y,q,{imagedata:{test:function(e){return"ImageData"===D.toStringTag(e)},replace:function(e){return{array:o(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return"ImageBitmap"===D.toStringTag(e)||e&&e.dataset&&"ImageBitmap"===e.dataset.toStringTag},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.addEventListener("load",function(){n.drawImage(r,0,0)}),r.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.addEventListener("load",function(){n.drawImage(r,0,0)}),r.src=e,createImageBitmap(t)}}},ue,{file:ue.file,filelist:{test:function(e){return"FileList"===D.toStringTag(e)},replace:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e.item(n);return t},revive:function(e){return new((function(){function e(){t(this,e),this._files=arguments[0],this.length=this._files.length}return(function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)})(e,[{key:"item",value:function(e){return this._files[e]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),e})())(e)}}},{blob:{test:function(e){return"Blob"===D.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,n=e.stringContents;return new Blob([ae(n)],{type:t})},replaceAsync:function(e){return new D.Promise(function(t,n){var r=new FileReader;r.addEventListener("load",function(){t({type:e.type,stringContents:r.result})}),r.addEventListener("error",function(){n(r.error)}),r.readAsBinaryString(e)})}}}].concat("function"==typeof Map?z:[],"function"==typeof Set?H:[],"function"==typeof ArrayBuffer?te:[],"function"==typeof Uint8Array?re:[],"function"==typeof DataView?ie:[],"undefined"!=typeof Intl?oe:[],"undefined"!=typeof crypto?fe:[],"undefined"!=typeof BigInt?[ce,se]:[])})()}),O='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',S=new Uint8Array(256),E=0;E<64;E++)S[O.codePointAt(E)]=E;var A=function(e,t,n){null==n&&(n=e.byteLength);for(var r=new Uint8Array(e,t||0,n),i=r.length,o='',a=0;a<i;a+=3)o+=O[r[a]>>2],o+=O[(3&r[a])<<4|r[a+1]>>4],o+=O[(15&r[a+1])<<2|r[a+2]>>6],o+=O[63&r[a+2]];return i%3==2?o=o.slice(0,-1)+'=':i%3==1&&(o=o.slice(0,-2)+'=='),o},T=function(e){var t,n,r,i,o=e.length,a=.75*e.length,u=0;'='===e[e.length-1]&&(a--,'='===e[e.length-2]&&a--);for(var c=new ArrayBuffer(a),s=new Uint8Array(c),f=0;f<o;f+=4)t=S[e.codePointAt(f)],n=S[e.codePointAt(f+1)],r=S[e.codePointAt(f+2)],i=S[e.codePointAt(f+3)],s[u++]=t<<2|n>>4,s[u++]=(15&n)<<4|r>>2,s[u++]=(3&r)<<6|63&i;return c},N='undefined'==typeof self?e:self,_={};['Int8Array','Uint8Array','Uint8ClampedArray','Int16Array','Uint16Array','Int32Array','Uint32Array','Float32Array','Float64Array'].forEach(function(e){var t=e,n=N[t];n&&(_[e.toLowerCase()+"2"]={test:function(e){return g.toStringTag(e)===t},replace:function(e){return{buffer:e.buffer,byteOffset:e.byteOffset,length:e.length}},revive:function(e){var t=e.buffer,r=e.byteOffset,i=e.length;return new n(t,r,i)}})});var j={arraybuffer:{test:function(e){return'ArrayBuffer'===g.toStringTag(e)},replace:function(e){return A(e,0,e.byteLength)},revive:function(e){return T(e)}}},P=(new g).register(w),I='FileReaderSync'in self,k=[],B=0;P.register([j,_,{blob2:{test:function(e){return'Blob'===g.toStringTag(e)},replace:function(e){if(e.isClosed)throw new Error('The Blob is closed');if(I){var t=v(e,'binary'),n=A(t,0,t.byteLength);return{type:e.type,data:n}}k.push(e);var r={type:e.type,data:{start:B,end:B+e.size}};return B+=e.size,r},finalize:function(e,t){e.data=A(t,0,t.byteLength)},revive:function(e){var t=e.type,n=e.data;return new Blob([T(n)],{type:t})}}}]),P.mustFinalize=function(){return k.length>0},P.finalize=function(e){return l(void 0,void 0,void 0,function(){var t,n,r,i,o,a,u,c,f,l,y,h;return p(this,function(p){switch(p.label){case 0:return[4,d(new Blob(k),'binary')];case 1:if(t=p.sent(),e)for(n=0,r=e;n<r.length;n++)if((i=r[n]).$types)for(u in o=i.$types,(a=o.$)&&(o=o.$),o)c=o[u],(f=P.types[c])&&f.finalize&&(l=s.default.getByKeyPath(i,a?"$."+u:u),f.finalize(l,t.slice(null===(y=l.data)||void 0===y?void 0:y.start,null===(h=l.data)||void 0===h?void 0:h.end)));return k=[],B=0,[2]}})})};var x=2e3;function C(e,t){return l(this,void 0,void 0,function(){function n(){return l(this,void 0,void 0,function(){var n,r,l,y,d,v,b,m,g,w;return p(this,function(O){switch(O.label){case 0:return[4,Promise.all(i.map(function(e){return e.count()}))];case 1:(n=O.sent()).forEach(function(e,t){return a[t].rowCount=e}),h.totalRows=n.reduce(function(e,t){return e+t}),r=JSON.stringify(c,void 0,u?2:void 0),l=r.lastIndexOf(']'),y=r.substring(0,l),o.push(y),d=t.filter,v=t.transform,b=function(n){var r,i,a,c,l,y,b,m,g,w,O;return p(this,function(S){switch(S.label){case 0:r=e.table(n),i=r.schema.primKey,a=!!i.keyPath,c=t.numRowsPerChunk||x,l=a?{tableName:r.name,inbound:!0,rows:[]}:{tableName:r.name,inbound:!1,rows:[]},y=JSON.stringify(l,void 0,u?2:void 0),u&&(y=y.split('\n').join('\n    ')),b=y.lastIndexOf(']'),o.push(y.substring(0,b)),m=null,g=0,w=!0,O=function(){var e,t,l,y,b,O,S,E,A;return p(this,function(p){switch(p.label){case 0:return f&&s.default.ignoreTransaction(function(){return f(h)}),[4,(e=null==m?r.limit(c):r.where(':id').above(m).limit(c)).toArray()];case 1:return 0===(t=p.sent()).length?[2,"break"]:(null!=m&&g>0&&(o.push(","),u&&o.push("\n      ")),w=t.length===c,a?(l=d?t.filter(function(e){return d(n,e)}):t,y=v?l.map(function(e){return v(n,e).value}):l,b=y.map(function(e){return P.encapsulate(e)}),P.mustFinalize()?[4,s.default.waitFor(P.finalize(b))]:[3,3]):[3,4]);case 2:p.sent(),p.label=3;case 3:return A=JSON.stringify(b,void 0,u?2:void 0),u&&(A=A.split('\n').join('\n      ')),o.push(new Blob([A.substring(1,A.length-1)])),g=y.length,m=t.length>0?s.default.getByKeyPath(t[t.length-1],i.keyPath):null,[3,8];case 4:return[4,e.primaryKeys()];case 5:return O=p.sent(),S=O.map(function(e,n){return[e,t[n]]}),d&&(S=S.filter(function(e){var t=e[0],r=e[1];return d(n,r,t)})),v&&(S=S.map(function(e){var t=e[0],r=e[1],i=v(n,r,t);return[i.key,i.value]})),E=S.map(function(e){return P.encapsulate(e)}),P.mustFinalize()?[4,s.default.waitFor(P.finalize(E))]:[3,7];case 6:p.sent(),p.label=7;case 7:A=JSON.stringify(E,void 0,u?2:void 0),u&&(A=A.split('\n').join('\n      ')),o.push(new Blob([A.substring(1,A.length-1)])),g=S.length,m=O.length>0?O[O.length-1]:null,p.label=8;case 8:return h.completedRows+=t.length,[2]}})},S.label=1;case 1:return w?[5,O()]:[3,3];case 2:return"break"===S.sent()?[3,3]:[3,1];case 3:return o.push(y.substr(b)),h.completedTables+=1,h.completedTables<h.totalTables&&o.push(","),[2]}})},m=0,g=a,O.label=2;case 2:return m<g.length?(w=g[m].name,[5,b(w)]):[3,5];case 3:O.sent(),O.label=4;case 4:return m++,[3,2];case 5:return o.push(r.substr(l)),h.done=!0,f&&s.default.ignoreTransaction(function(){return f(h)}),[2]}})})}var r,i,o,a,u,c,f,h;return p(this,function(s){switch(s.label){case 0:r=(t=t||{}).skipTables?t.skipTables:[],i=e.tables.filter(function(e){return!r.includes(e.name)}),o=[],a=i.map(function(e){return{name:e.name,schema:y(e),rowCount:0}}),u=t.prettyJson,c={formatName:"dexie",formatVersion:1,data:{databaseName:e.name,databaseVersion:e.verno,tables:a,data:[]}},f=t.progressCallback,h={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:a.length},s.label=1;case 1:return s.trys.push([1,,6,7]),t.noTransaction?[4,n()]:[3,3];case 2:return s.sent(),[3,5];case 3:return[4,e.transaction('r',e.tables,n)];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:return P.finalize(),[7];case 7:return[2,new Blob(o,{type:"text/json"})]}})})}var L=1,U=function(){},R=m(function(e,t){!(function(e){var t='object'==typeof process&&process.env?process.env:self;e.parser=function(e){return new D(e)},e.CParser=D,e.CStream=V,e.createStream=function(e){return new V(e)},e.MAX_BUFFER_LENGTH=10485760,e.DEBUG='debug'===t.CDEBUG,e.INFO='debug'===t.CDEBUG||'info'===t.CDEBUG,e.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var n,r={textNode:void 0,numberNode:""},i=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e}),o=0;for(var a in e.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++},e.STATE)e.STATE[e.STATE[a]]=a;o=e.STATE;const u=9,c=10,s=13,f=32,l=34,p=43,y=44,h=45,d=46,v=48,b=57,m=58,g=69,w=91,O=92,S=93,E=97,A=98,T=101,N=102,_=108,j=110,P=114,I=115,k=116,B=117,x=123,C=125;function L(t){var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0;for(var o in r){var a=void 0===t[o]?0:t[o].length;if(a>n)if("text"===o)closeText(t);else Y(t,"Max buffer length exceeded: "+o);i=Math.max(i,a)}t.bufferCheckPosition=e.MAX_BUFFER_LENGTH-i+t.position}function R(e){for(var t in r)e[t]=r[t]}Object.create||(Object.create=function(e){function t(){this.__proto__=e}return t.prototype=e,new t}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var F=/[\\"\n]/g;function D(t){if(!(this instanceof D))return new D(t);var n=this;R(n),n.bufferCheckPosition=e.MAX_BUFFER_LENGTH,n.q=n.c=n.p="",n.opt=t||{},n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.state=o.BEGIN,n.stack=new Array,n.position=n.column=0,n.line=1,n.slashed=!1,n.unicodeI=0,n.unicodeS=null,n.depth=0,K(n,"onready")}D.prototype={end:function(){q(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return Y(n,"Cannot write after close. Assign an onready handler.");if(null===t)return q(n);var r=0,i=t.charCodeAt(0),a=n.p;e.DEBUG&&console.log('write -> ['+t+']');for(;i&&(a=i,n.c=i=t.charCodeAt(r++),a!==i?n.p=a:a=n.p,i);)switch(e.DEBUG&&console.log(r,i,e.STATE[n.state]),n.position++,i===c?(n.line++,n.column=0):n.column++,n.state){case o.BEGIN:i===x?n.state=o.OPEN_OBJECT:i===w?n.state=o.OPEN_ARRAY:z(i)||Y(n,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(z(i))continue;if(n.state===o.OPEN_KEY)n.stack.push(o.CLOSE_KEY);else{if(i===C){K(n,'onopenobject'),this.depth++,K(n,'oncloseobject'),this.depth--,n.state=n.stack.pop()||o.VALUE;continue}n.stack.push(o.CLOSE_OBJECT)}i===l?n.state=o.STRING:Y(n,"Malformed object key should start with \"");continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(z(i))continue;n.state,o.CLOSE_KEY,i===m?(n.state===o.CLOSE_OBJECT?(n.stack.push(o.CLOSE_OBJECT),J(n,'onopenobject'),this.depth++):J(n,'onkey'),n.state=o.VALUE):i===C?(M(n,'oncloseobject'),this.depth--,n.state=n.stack.pop()||o.VALUE):i===y?(n.state===o.CLOSE_OBJECT&&n.stack.push(o.CLOSE_OBJECT),J(n),n.state=o.OPEN_KEY):Y(n,'Bad object');continue;case o.OPEN_ARRAY:case o.VALUE:if(z(i))continue;if(n.state===o.OPEN_ARRAY){if(K(n,'onopenarray'),this.depth++,n.state=o.VALUE,i===S){K(n,'onclosearray'),this.depth--,n.state=n.stack.pop()||o.VALUE;continue}n.stack.push(o.CLOSE_ARRAY)}i===l?n.state=o.STRING:i===x?n.state=o.OPEN_OBJECT:i===w?n.state=o.OPEN_ARRAY:i===k?n.state=o.TRUE:i===N?n.state=o.FALSE:i===j?n.state=o.NULL:i===h?n.numberNode+="-":v<=i&&i<=b?(n.numberNode+=String.fromCharCode(i),n.state=o.NUMBER_DIGIT):Y(n,"Bad value");continue;case o.CLOSE_ARRAY:if(i===y)n.stack.push(o.CLOSE_ARRAY),J(n,'onvalue'),n.state=o.VALUE;else if(i===S)M(n,'onclosearray'),this.depth--,n.state=n.stack.pop()||o.VALUE;else{if(z(i))continue;Y(n,'Bad array')}continue;case o.STRING:void 0===n.textNode&&(n.textNode="");var u=r-1,s=n.slashed,f=n.unicodeI;e:for(;;){for(e.DEBUG&&console.log(r,i,e.STATE[n.state],s);f>0;)if(n.unicodeS+=String.fromCharCode(i),i=t.charCodeAt(r++),n.position++,4===f?(n.textNode+=String.fromCharCode(parseInt(n.unicodeS,16)),f=0,u=r-1):f++,!i)break e;if(i===l&&!s){n.state=n.stack.pop()||o.VALUE,n.textNode+=t.substring(u,r-1),n.position+=r-1-u;break}if(i===O&&!s&&(s=!0,n.textNode+=t.substring(u,r-1),n.position+=r-1-u,i=t.charCodeAt(r++),n.position++,!i))break;if(s){if(s=!1,i===j?n.textNode+='\n':i===P?n.textNode+='\r':i===k?n.textNode+='\t':i===N?n.textNode+='\f':i===A?n.textNode+='\b':i===B?(f=1,n.unicodeS=''):n.textNode+=String.fromCharCode(i),i=t.charCodeAt(r++),n.position++,u=r-1,i)continue;break}F.lastIndex=r;var U=F.exec(t);if(null===U){r=t.length+1,n.textNode+=t.substring(u,r-1),n.position+=r-1-u;break}if(r=U.index+1,!(i=t.charCodeAt(U.index))){n.textNode+=t.substring(u,r-1),n.position+=r-1-u;break}}n.slashed=s,n.unicodeI=f;continue;case o.TRUE:i===P?n.state=o.TRUE2:Y(n,'Invalid true started with t'+i);continue;case o.TRUE2:i===B?n.state=o.TRUE3:Y(n,'Invalid true started with tr'+i);continue;case o.TRUE3:i===T?(K(n,"onvalue",!0),n.state=n.stack.pop()||o.VALUE):Y(n,'Invalid true started with tru'+i);continue;case o.FALSE:i===E?n.state=o.FALSE2:Y(n,'Invalid false started with f'+i);continue;case o.FALSE2:i===_?n.state=o.FALSE3:Y(n,'Invalid false started with fa'+i);continue;case o.FALSE3:i===I?n.state=o.FALSE4:Y(n,'Invalid false started with fal'+i);continue;case o.FALSE4:i===T?(K(n,"onvalue",!1),n.state=n.stack.pop()||o.VALUE):Y(n,'Invalid false started with fals'+i);continue;case o.NULL:i===B?n.state=o.NULL2:Y(n,'Invalid null started with n'+i);continue;case o.NULL2:i===_?n.state=o.NULL3:Y(n,'Invalid null started with nu'+i);continue;case o.NULL3:i===_?(K(n,"onvalue",null),n.state=n.stack.pop()||o.VALUE):Y(n,'Invalid null started with nul'+i);continue;case o.NUMBER_DECIMAL_POINT:i===d?(n.numberNode+=".",n.state=o.NUMBER_DIGIT):Y(n,'Leading zero not followed by .');continue;case o.NUMBER_DIGIT:v<=i&&i<=b?n.numberNode+=String.fromCharCode(i):i===d?(-1!==n.numberNode.indexOf('.')&&Y(n,'Invalid number has two dots'),n.numberNode+="."):i===T||i===g?(-1===n.numberNode.indexOf('e')&&-1===n.numberNode.indexOf('E')||Y(n,'Invalid number has two exponential'),n.numberNode+="e"):i===p||i===h?(a!==T&&a!==g&&Y(n,'Invalid symbol in number'),n.numberNode+=String.fromCharCode(i)):($(n),r--,n.state=n.stack.pop()||o.VALUE);continue;default:Y(n,"Unknown state: "+n.state)}n.position>=n.bufferCheckPosition&&L(n);return n},resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{n=U}catch(e){n=function(){}}function V(e){if(!(this instanceof V))return new V(e);this._parser=new D(e),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string='';var t=this;n.apply(t),this._parser.onend=function(){t.emit("end")},this._parser.onerror=function(e){t.emit("error",e),t._parser.error=null},i.forEach(function(e){Object.defineProperty(t,"on"+e,{get:function(){return t._parser["on"+e]},set:function(n){if(!n)return t.removeAllListeners(e),t._parser["on"+e]=n,n;t.on(e,n)},enumerable:!0,configurable:!1})})}function K(t,n,r){e.INFO&&console.log('-- emit',n,r),t[n]&&t[n](r)}function M(e,t,n){J(e),K(e,t,n)}function J(e,t){e.textNode=G(e.opt,e.textNode),void 0!==e.textNode&&K(e,t||"onvalue",e.textNode),e.textNode=void 0}function $(e){e.numberNode&&K(e,"onvalue",parseFloat(e.numberNode)),e.numberNode=""}function G(e,t){return void 0===t||(e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," "))),t}function Y(e,t){return J(e),t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c,t=new Error(t),e.error=t,K(e,"onerror",t),e}function q(e){return e.state===o.VALUE&&0===e.depth||Y(e,"Unexpected end"),J(e),e.c="",e.closed=!0,K(e,"onend"),D.call(e,e.opt),e}function z(e){return e===s||e===c||e===f||e===u}V.prototype=Object.create(n.prototype,{constructor:{value:V}}),V.prototype.write=function(e){e=new Buffer(e);for(var t=0;t<e.length;t++){var n=e[t];if(this.bytes_remaining>0){for(var r=0;r<this.bytes_remaining;r++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+r]=e[r];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,t=t+r-1,this._parser.write(this.string),this.emit("data",this.string)}else if(0===this.bytes_remaining&&n>=128){if(n>=194&&n<=223&&(this.bytes_in_sequence=2),n>=224&&n<=239&&(this.bytes_in_sequence=3),n>=240&&n<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+t>e.length){for(var i=0;i<=e.length-1-t;i++)this.temp_buffs[this.bytes_in_sequence][i]=e[t+i];return this.bytes_remaining=t+this.bytes_in_sequence-e.length,!0}this.string=e.slice(t,t+this.bytes_in_sequence).toString(),t=t+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string)}else{for(var o=t;o<e.length&&!(e[o]>=128);o++);this.string=e.slice(t,o).toString(),this._parser.write(this.string),this.emit("data",this.string),t=o-1}}},V.prototype.end=function(e){return e&&e.length&&this._parser.write(e.toString()),this._parser.end(),!0},V.prototype.on=function(e,t){var r=this;return r._parser["on"+e]||-1===i.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),n.prototype.on.call(r,e,t)},V.prototype.destroy=function(){R(this._parser),this.emit("close")}})(t)});function F(e){var t=0,n=D(!0),r={pullAsync:function(i){return l(this,void 0,void 0,function(){var o,a,u;return p(this,function(c){switch(c.label){case 0:return o=e.slice(t,t+i),t+=i,[4,d(o,'text')];case 1:return a=c.sent(),u=n.write(a),r.result=u||{},[2,u]}})})},pullSync:function(i){var o=e.slice(t,t+i);t+=i;var a=v(o,'text'),u=n.write(a);return r.result=u||{},u},done:function(){return n.done()},eof:function(){return t>=e.size},result:{}};return r}function D(e){var t,n,r,i=R.parser(),o=0,a=[],u=!1,c=!1;return i.onopenobject=function(i){var u={incomplete:!0};t||(t=u),n&&(a.push([r,n,c]),e&&(c?n.push(u):n[r]=u)),n=u,r=i,c=!1,++o},i.onkey=function(e){return r=e},i.onvalue=function(e){return c?n.push(e):n[r]=e},i.oncloseobject=function(){var t;if(delete n.incomplete,r=null,0===--o)u=!0;else{var i=n;t=a.pop(),r=t[0],n=t[1],c=t[2],e||(c?n.push(i):n[r]=i)}},i.onopenarray=function(){var i=[];i.incomplete=!0,t||(t=i),n&&(a.push([r,n,c]),e&&(c?n.push(i):n[r]=i)),n=i,c=!0,r=null,++o},i.onclosearray=function(){var t;if(delete n.incomplete,r=null,0===--o)u=!0;else{var i=n;t=a.pop(),r=t[0],n=t[1],c=t[2],e||(c?n.push(i):n[r]=i)}},{write:function(e){return i.write(e),t},done:function(){return u}}}function V(e,t){return l(this,void 0,void 0,function(){var n,r,i,o;return p(this,function(a){switch(a.label){case 0:return n=(t=t||{}).chunkSizeBytes||1048576,[4,J(e,n)];case 1:return r=a.sent(),i=r.result.data,(o=new s.default(void 0!==t.name?t.name:i.databaseName)).version(i.databaseVersion).stores(h(i)),[4,M(o,r,void 0!==t.name?f(f({},t),{acceptNameDiff:!0}):t)];case 2:return a.sent(),[2,o]}})})}function K(e){return l(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:t=F(e),n.label=1;case 1:return t.eof()?[3,3]:[4,t.pullAsync(5120)];case 2:return n.sent(),t.result.data&&t.result.data.data?(delete t.result.data.data,[3,3]):[3,1];case 3:return[2,t.result]}})})}function M(e,t,n){return l(this,void 0,void 0,function(){function r(){return l(this,void 0,void 0,function(){var t,r,a,l;return p(this,function(d){switch(d.label){case 0:t=function(t){var r,i,o,a,u,l,d,v,b,m,g,w,O;return p(this,function(p){switch(p.label){case 0:if(f.includes(t.tableName))return[2,"continue"];if(!t.rows)return[2,"break"];if(!t.rows.incomplete&&0===t.rows.length)return[2,"continue"];if(y&&s.default.ignoreTransaction(function(){return y(h)}),r=t.tableName,i=e.table(r),o=c.tables.filter(function(e){return e.name===r})[0].schema,!i){if(n.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(t.tableName," is missing in installed database"))}if(!n.acceptChangedPrimaryKey&&o.split(',')[0]!=i.schema.primKey.src)throw new Error("Primary key differs for table ".concat(t.tableName,". "));for(a=t.rows,u=[],l=0;l<a.length&&!(d=a[l]).incomplete;l++)u.push(P.revive(d));return v=n.filter,b=n.transform,m=v?t.inbound?u.filter(function(e){return v(r,e)}):u.filter(function(e){var t=e[0],n=e[1];return v(r,n,t)}):u,b&&(m=m.map(t.inbound?function(e){return b(r,e).value}:function(e){var t=e[0],n=e[1],i=b(r,n,t);return[i.key,i.value]})),g=t.inbound?[void 0,m]:[m.map(function(e){return e[0]}),u.map(function(e){return e[1]})],w=g[0],O=g[1],n.overwriteValues?[4,i.bulkPut(O,w)]:[3,2];case 1:return p.sent(),[3,4];case 2:return[4,i.bulkAdd(O,w)];case 3:p.sent(),p.label=4;case 4:return h.completedRows+=u.length,u.incomplete||(h.completedTables+=1),a.splice(0,u.length),[2]}})},r=0,a=c.data,d.label=1;case 1:return r<a.length?(l=a[r],[5,t(l)]):[3,4];case 2:if("break"===d.sent())return[3,4];d.label=3;case 3:return r++,[3,1];case 4:for(;c.data.length>0&&c.data[0].rows&&!c.data[0].rows.incomplete;)c.data.splice(0,1);return o.done()||o.eof()?[3,8]:u?(o.pullSync(i),[3,7]):[3,5];case 5:return[4,s.default.waitFor(o.pullAsync(i))];case 6:d.sent(),d.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var i,o,a,u,c,f,y,h,d,v,b;return p(this,function(l){switch(l.label){case 0:return i=(n=n||{}).chunkSizeBytes||1048576,[4,J(t,i)];case 1:if(o=l.sent(),a=o.result,u='FileReaderSync'in self,c=a.data,f=n.skipTables?n.skipTables:[],!n.acceptNameDiff&&e.name!==c.databaseName)throw new Error("Name differs. Current database name is ".concat(e.name," but export is ").concat(c.databaseName));if(!n.acceptVersionDiff&&e.verno!==c.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(e.verno," but export is ").concat(c.databaseVersion));if(y=n.progressCallback,h={done:!1,completedRows:0,completedTables:0,totalRows:c.tables.reduce(function(e,t){return e+t.rowCount},0),totalTables:c.tables.length},y&&s.default.ignoreTransaction(function(){return y(h)}),!n.clearTablesBeforeImport)return[3,5];d=0,v=e.tables,l.label=2;case 2:return d<v.length?(b=v[d],f.includes(b.name)?[3,4]:[4,b.clear()]):[3,5];case 3:l.sent(),l.label=4;case 4:return d++,[3,2];case 5:return n.noTransaction?[4,r()]:[3,7];case 6:return l.sent(),[3,9];case 7:return[4,e.transaction('rw',e.tables,r)];case 8:l.sent(),l.label=9;case 9:return h.done=!0,y&&s.default.ignoreTransaction(function(){return y(h)}),[2]}})})}function J(e,t){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:n='slice'in e?F(e):e,i.label=1;case 1:return n.eof()?[3,3]:[4,n.pullAsync(t)];case 2:return i.sent(),n.result.data&&n.result.data.data?[3,3]:[3,1];case 3:if(!(r=n.result)||"dexie"!=r.formatName)throw new Error("Given file is not a dexie export");if(r.formatVersion>L)throw new Error("Format version ".concat(r.formatVersion," not supported"));if(!r.data)throw new Error("No data in export file");if(!r.data.databaseName)throw new Error("Missing databaseName in export file");if(!r.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!r.data.tables)throw new Error("Missing tables in export file");return[2,n]}})})}s.default.prototype.export=function(e){return C(this,e)},s.default.prototype.import=function(e,t){return M(this,e,t)},s.default.import=function(e,t){return V(e,t)};var $=function(){throw new Error("This addon extends Dexie.prototype globally and does not have be included in Dexie constructor's addons options.")}},6612,[3378]);